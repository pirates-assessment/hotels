!function(a){"use strict";var b=function(){var b="http://fake-hotel-api.herokuapp.com/api/",c=function(){return a.ajax({url:b+"hotels",dataType:"jsonp",cache:!1})},d=function(c){return a.ajax({url:b+"reviews",dataType:"jsonp",cache:!1,data:{hotel_id:c}})};return{getHotelsList:c,getHotelReviews:d}}(),c=function(){var b=5,c=function(b){return a("<div/>").html(b).text()},d=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},e=function(a,b){return d(a)+" - "+d(b)},f=function(a,b){var c=new Date(a),d=new Date(b);return c.getDate()+"."+(c.getMonth()+1)+"."+c.getFullYear()+" - "+d.getDate()+"."+(d.getMonth()+1)+"."+d.getFullYear()},g=function(a,b){var g=b.images[0]||"",h=b.name||"",i=b.city||"",j=b.country||"",k=b.description||"",l=b.price||"",m=b.date_start||"",n=b.date_end||"",o=b.id||0,p=b.stars||0;a.find("img").prop("src",c(g)),a.find(".single-content__name").find("h1").text(d(h)),a.find(".single-content__name").find("span").text(e(i,j)),a.find("article").text(k),a.find(".price").find("span").text(l),a.find(".date").text(f(m,n)),a.find(".show-reviews").attr("data-hotel",o),a.find(".single-content__stars").rateYo({rating:p,starWidth:"25px"}),a.removeClass("hide")},h=function(a,b){var c=b.name||"",d=b.comment||"",e=b.positive||"";a.find(".name").text(c),a.find(".content").text(d),e?a.find(".plus").removeClass("hide"):a.find(".minus").removeClass("hide"),a.removeClass("hide")},i=function(c){var d,e=a(".single").last(),f=a("#hotels"),h=0;f.html("");var i=setInterval(function(){var a=c[h];return h==b?clearInterval(i):(e.clone().appendTo(f),d=f.find(".single").eq(h),g(d,a),void h++)},300)},j=function(a,b){var c,d,e,f=a.closest(".row"),g=f.find(".single-review"),i=f.find(".reviews"),j=b.length;for(a.addClass(".visible"),e=0;e<j;e++)d=b[e],g.clone().appendTo(i),c=i.find(".single-review").eq(e),h(c,d),e==j-1&&c.find("hr").remove();i.slideToggle()};return{renderHotelsList:i,renderHotelReviews:j}}();a(document).ready(function(){a("#load-hotels").on("click",function(d){var e=a(".loader"),f=a("#load-error");e.removeClass("hide"),b.getHotelsList().done(function(a){var b=a||{};e.addClass("hide"),f.is(":visible")?f.addClass("hide"):"",c.renderHotelsList(b)}).fail(function(b){a("#hotels").html(""),e.addClass("hide"),f.removeClass("hide")})}),a("#hotels").on("click",".show-reviews",function(d){var e=a(this),f=e.data("hotel")||"",g=e.closest(".row").find(".reviews");g.contents().length?g.slideToggle():b.getHotelReviews(f).done(function(a){var b=a||{};b.length&&c.renderHotelReviews(e,b)}).fail(function(a){}),"Show reviews"==e.text()?e.text("Hide reviews"):e.text("Show reviews")})})}(jQuery);